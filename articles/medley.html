<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>medley: Predictive Modeling with Missing Data • medley</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="medley: Predictive Modeling with Missing Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">medley</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/medley.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jbryer/medley/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>medley: Predictive Modeling with Missing Data</h1>
                        <h4 data-toc-skip class="author">Jason Bryer,
Ph.D.</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jbryer/medley/blob/master/vignettes/medley.Rmd" class="external-link"><code>vignettes/medley.Rmd</code></a></small>
      <div class="d-none name"><code>medley.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Most predictive modeling strategies require complete data to train
and predict outcomes. A common strategy is to impute the missing data
before training the models. However, in many situations, missing data
occurs in a systematic way therefore violating the missing completely at
random (MCAR) assumption. For instance, data may be collected over
multiple time periods or the available data may vary depending on
varying collection protocols or selection bias at the individual level.
The <code>medley</code> package provides a framework for estimating
predictive model that takes into account the patterns of missing
data.</p>
<p>The motivating example for this approach predictive modeling comes
from predicting student success in college. Institutions have become
increasingly interested in using predictive models to identify students
at risk for attrition as early as possible in order to provided targeted
interventions and supports. Information about students is collected over
several months beginning at the college application phase, commitment to
enroll, orientation, and finally behavior data as the student begins
coursework. In addition to missing data being related to where the
student is in the process, students may opt to not provide certain data
elements. This results in a complex system where a single predictive
model is appropriate.</p>
</div>
<div class="section level2">
<h2 id="data-source">Data Source<a class="anchor" aria-label="anchor" href="#data-source"></a>
</h2>
<p>This paper will explore data from the Diagnostic Assessment and
Achievement of College Skills (DAACS; <a href="https://daacs.net" class="external-link uri">https://daacs.net</a>). DAACS is a suite of technological
and social supports designed to optimize student learning. Students
complete assessments in self-regulated learning, writing, mathematics,
and reading and upon completion receive immediate feedback in terms of
developing, emerging, and mastering. The feedback is tailored to their
results. The data for this paper was part of a larger randomized control
trial where DAACS was embedded within orientation for the treatment
students. Although students were instructed that orientation was
required, there were no consequences for not completing orientation and
therefore approximately 43% of students did not attempt orientation, and
therefore did not complete DAACS. The goal is to predicted term-to-term
retention (the <code>retained</code> variable) for each student based
upon the available data. Table @ref(tab:descriptives) for descriptive
statistics which reveals that the DAACS results are not complete for
some students. The overall retention rate is 56.17%.</p>
<table class="table">
<caption>
Descriptive Statistics
</caption>
<thead><tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
Mean
</th>
<th style="text-align:left;">
Std Dev
</th>
<th style="text-align:left;">
Median
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
retained
</td>
<td style="text-align:left;">
5154
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
… No
</td>
<td style="text-align:left;">
2259
</td>
<td style="text-align:left;">
44%
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
… Yes
</td>
<td style="text-align:left;">
2895
</td>
<td style="text-align:left;">
56%
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
page_views
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
39
</td>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
34
</td>
</tr>
<tr>
<td style="text-align:left;">
srl
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
2.8
</td>
<td style="text-align:left;">
0.43
</td>
<td style="text-align:left;">
2.8
</td>
</tr>
<tr>
<td style="text-align:left;">
math
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0.58
</td>
<td style="text-align:left;">
0.2
</td>
<td style="text-align:left;">
0.61
</td>
</tr>
<tr>
<td style="text-align:left;">
reading
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0.85
</td>
<td style="text-align:left;">
0.17
</td>
<td style="text-align:left;">
0.89
</td>
</tr>
<tr>
<td style="text-align:left;">
writing
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0.78
</td>
<td style="text-align:left;">
0.16
</td>
<td style="text-align:left;">
0.83
</td>
</tr>
<tr>
<td style="text-align:left;">
income
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
4.4
</td>
<td style="text-align:left;">
2.4
</td>
<td style="text-align:left;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
employment
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
2.6
</td>
<td style="text-align:left;">
0.75
</td>
<td style="text-align:left;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
ell
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0.93
</td>
<td style="text-align:left;">
0.26
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
ed_mother
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
3.3
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
ed_father
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
3.2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
ethnicity
</td>
<td style="text-align:left;">
5154
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
… Black or African American
</td>
<td style="text-align:left;">
1049
</td>
<td style="text-align:left;">
20%
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
… Hispanic
</td>
<td style="text-align:left;">
699
</td>
<td style="text-align:left;">
14%
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
… Other
</td>
<td style="text-align:left;">
548
</td>
<td style="text-align:left;">
11%
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
… White
</td>
<td style="text-align:left;">
2858
</td>
<td style="text-align:left;">
55%
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
gender
</td>
<td style="text-align:left;">
5154
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
… FEMALE
</td>
<td style="text-align:left;">
2123
</td>
<td style="text-align:left;">
41%
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
… MALE
</td>
<td style="text-align:left;">
3031
</td>
<td style="text-align:left;">
59%
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
military
</td>
<td style="text-align:left;">
5154
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
… No
</td>
<td style="text-align:left;">
2881
</td>
<td style="text-align:left;">
56%
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
… Yes
</td>
<td style="text-align:left;">
2273
</td>
<td style="text-align:left;">
44%
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
9.3
</td>
<td style="text-align:left;">
34
</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="missing-data-patterns">Missing Data Patterns<a class="anchor" aria-label="anchor" href="#missing-data-patterns"></a>
</h3>
<p>To begin we first explore the patterns of missing data. Figure
@ref(fig:upset) is an UpSet plot <span class="citation">(Gu, Eils, and
Schlesner 2016)</span> created from a shadow matrix<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;A shadow matrix has the same dimensions of the original
data but the values correspond to whether the observation is missing
(&lt;code&gt;FALSE&lt;/code&gt;) or not (&lt;code&gt;TRUE&lt;/code&gt;).&lt;/p&gt;"><sup>1</sup></a>. Each vertical line
corresponds to a set, or combination, of variables. The dots indicate
that that variable is included in the set. The bars on the top
correspond to the number of observations in that set and the bars to the
right correspond to the total number of observed values. The largest set
includes only the demographics variables, the second largest included
demographics and all DAACS variables. There is a third set that includes
self-regulated learning along with demographics that is worth
considering since it contains more than 10% of the observations. It
should be noted that there is a potential fourth set which included
demographic variables along with three of DAACS variables (SRL, reading,
and math). However, since this set has fewer than 10% of the
observations we will use a three set/model solution.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shadow_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">daacs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/make_comb_mat.html" class="external-link">make_comb_mat</a></span><span class="op">(</span><span class="va">shadow_matrix</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/UpSet.html" class="external-link">UpSet</a></span><span class="op">(</span>right_annotation <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="medley_files/figure-html/upset-1.png" alt="UpSet plot of the missing data" width="624"><p class="caption">
UpSet plot of the missing data
</p>
</div>
</div>
<div class="section level3">
<h3 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h3>
<p>To perform the predictive modeling we will split the data into
training (70%) and validation (30%) data sets.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2112</span><span class="op">)</span>; <span class="va">train_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">daacs</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">daacs</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="va">daacs_train</span> <span class="op">&lt;-</span> <span class="va">daacs</span><span class="op">[</span><span class="va">train_rows</span>,<span class="op">]</span></span>
<span><span class="va">daacs_valid</span> <span class="op">&lt;-</span> <span class="va">daacs</span><span class="op">[</span><span class="op">-</span><span class="va">train_rows</span>,<span class="op">]</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="baseline-models">Baseline Models<a class="anchor" aria-label="anchor" href="#baseline-models"></a>
</h2>
<p>There are generally two choices when estimating models when there is
missing data: 1) Model using only the available data or 2) Impute the
missing data before modeling.</p>
<div class="section level3">
<h3 id="using-available-data">Using available data<a class="anchor" aria-label="anchor" href="#using-available-data"></a>
</h3>
<p>In the DAACS data set as depicted in Figure @ref(fig:upset) the
demographics variables were observed for all students. To start we train
a logistic regression model on the training data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lr_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">daacs_train</span>,</span>
<span>              formula <span class="op">=</span> <span class="va">retained</span> <span class="op">~</span> <span class="va">income</span> <span class="op">+</span> <span class="va">employment</span> <span class="op">+</span> <span class="va">ell</span> <span class="op">+</span> <span class="va">ed_mother</span> <span class="op">+</span> <span class="va">ed_father</span> <span class="op">+</span></span>
<span>                <span class="va">ethnicity</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">military</span> <span class="op">+</span> <span class="va">age</span>,</span>
<span>              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">'logit'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rf_out</span> <span class="op">&lt;-</span> <span class="fu">randomForest</span><span class="op">(</span>formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">retained</span><span class="op">)</span> <span class="op">~</span> <span class="va">income</span> <span class="op">+</span> <span class="va">employment</span> <span class="op">+</span> <span class="va">ell</span> <span class="op">+</span> <span class="va">ed_mother</span> <span class="op">+</span> <span class="va">ed_father</span> <span class="op">+</span></span>
<span>                         <span class="va">ethnicity</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">military</span> <span class="op">+</span> <span class="va">age</span>,</span>
<span>                       data <span class="op">=</span> <span class="va">daacs_train</span><span class="op">)</span></span></code></pre></div>
<p>We can get predicted values from the validation data set and print
the confusion matrix.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lr_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">lr_out</span>, newdata <span class="op">=</span> <span class="va">daacs_valid</span>, type <span class="op">=</span> <span class="st">'response'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/confusion_matrix.html">confusion_matrix</a></span><span class="op">(</span>observed <span class="op">=</span> <span class="va">daacs_valid</span><span class="op">$</span><span class="va">retained</span>,</span>
<span>                 predicted <span class="op">=</span> <span class="va">lr_predictions</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt;               predicted             </span></span>
<span><span class="co">#&gt;   observed        FALSE         TRUE</span></span>
<span><span class="co">#&gt;      FALSE 295 (19.07%) 386 (24.95%)</span></span>
<span><span class="co">#&gt;       TRUE 216 (13.96%) 650 (42.02%)</span></span>
<span><span class="co">#&gt; Accuracy: 61.09%</span></span>
<span></span>
<span><span class="va">rf_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf_out</span>, newdata <span class="op">=</span> <span class="va">daacs_valid</span>, type <span class="op">=</span> <span class="st">'response'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/confusion_matrix.html">confusion_matrix</a></span><span class="op">(</span>observed <span class="op">=</span> <span class="va">daacs_valid</span><span class="op">$</span><span class="va">retained</span>,</span>
<span>                 predicted <span class="op">=</span> <span class="va">rf_predictions</span><span class="op">)</span></span>
<span><span class="co">#&gt;               predicted             </span></span>
<span><span class="co">#&gt;   observed        FALSE         TRUE</span></span>
<span><span class="co">#&gt;      FALSE 279 (18.03%) 402 (25.99%)</span></span>
<span><span class="co">#&gt;       TRUE 251 (16.22%) 615 (39.75%)</span></span>
<span><span class="co">#&gt; Accuracy: 57.79%</span></span></code></pre></div>
<p>The overall accuracy using only the demographic variables is
61.09%</p>
</div>
<div class="section level3">
<h3 id="mean-imputation">Mean Imputation<a class="anchor" aria-label="anchor" href="#mean-imputation"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">daacs_complete_mean</span> <span class="op">&lt;-</span> <span class="va">daacs</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">daacs_complete_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">missing_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">daacs_complete_mean</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">missing_rows</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">daacs_complete_mean</span><span class="op">[</span><span class="va">missing_rows</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">daacs_complete_mean</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">daacs_train_complete_mean</span> <span class="op">&lt;-</span> <span class="va">daacs_complete_mean</span><span class="op">[</span><span class="va">train_rows</span>,<span class="op">]</span></span>
<span><span class="va">daacs_valid_complete_mean</span> <span class="op">&lt;-</span> <span class="va">daacs_complete_mean</span><span class="op">[</span><span class="op">-</span><span class="va">train_rows</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">mean_lr_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">retained</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">daacs_train_complete_mean</span>,</span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="va">logit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mean_lr_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mean_lr_out</span>, newdata <span class="op">=</span> <span class="va">daacs_valid_complete_mean</span>, type <span class="op">=</span> <span class="st">'response'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/confusion_matrix.html">confusion_matrix</a></span><span class="op">(</span>observed <span class="op">=</span> <span class="va">daacs_valid_complete_mean</span><span class="op">$</span><span class="va">retained</span>,</span>
<span>                 predicted <span class="op">=</span> <span class="va">mean_lr_predictions</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt;               predicted             </span></span>
<span><span class="co">#&gt;   observed        FALSE         TRUE</span></span>
<span><span class="co">#&gt;      FALSE 292 (18.88%) 389 (25.15%)</span></span>
<span><span class="co">#&gt;       TRUE 212 (13.70%) 654 (42.28%)</span></span>
<span><span class="co">#&gt; Accuracy: 61.15%</span></span>
<span></span>
<span><span class="va">mean_rf_out</span> <span class="op">&lt;-</span> <span class="fu">randomForest</span><span class="op">(</span>formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">retained</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                            data <span class="op">=</span> <span class="va">daacs_train_complete_mean</span><span class="op">)</span></span>
<span><span class="va">mean_rf_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mean_rf_out</span>, newdata <span class="op">=</span> <span class="va">daacs_valid_complete_mean</span>, type <span class="op">=</span> <span class="st">'response'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/confusion_matrix.html">confusion_matrix</a></span><span class="op">(</span>observed <span class="op">=</span> <span class="va">daacs_valid_complete_mean</span><span class="op">$</span><span class="va">retained</span>,</span>
<span>                 predicted <span class="op">=</span> <span class="va">mean_rf_predictions</span><span class="op">)</span></span>
<span><span class="co">#&gt;               predicted             </span></span>
<span><span class="co">#&gt;   observed        FALSE         TRUE</span></span>
<span><span class="co">#&gt;      FALSE 316 (20.43%) 365 (23.59%)</span></span>
<span><span class="co">#&gt;       TRUE 178 (11.51%) 688 (44.47%)</span></span>
<span><span class="co">#&gt; Accuracy: 64.9%</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multiple-imputation">Multiple imputation<a class="anchor" aria-label="anchor" href="#multiple-imputation"></a>
</h3>
<p>Another common approach to modeling with missing data is multiple
imputation. The <code>mice</code> package (Multivariate Imputations by
Chained Equations) is a robust and popular approach to imputing missing
data. For simplicity we will use the final imputed data set for
comparison<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;There are multiple approaches suggested for getting
predicted values from models trained using imputed data sets. For a more
detailed explenation see this Github issue: &lt;a href="https://github.com/amices/mice/issues/82" class="external-link uri"&gt;https://github.com/amices/mice/issues/82&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mice_out</span> <span class="op">&lt;-</span> <span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice</a></span><span class="op">(</span><span class="va">daacs</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, M <span class="op">=</span> <span class="fl">5</span>, seed <span class="op">=</span> <span class="fl">2112</span>, printFlag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">daacs_complete_mice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>retained <span class="op">=</span> <span class="va">daacs</span><span class="op">$</span><span class="va">retained</span>, <span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/complete.html" class="external-link">complete</a></span><span class="op">(</span><span class="va">mice_out</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">daacs_train_complete_mice</span> <span class="op">&lt;-</span> <span class="va">daacs_complete_mice</span><span class="op">[</span><span class="va">train_rows</span>,<span class="op">]</span></span>
<span><span class="va">daacs_valid_complete_mice</span> <span class="op">&lt;-</span> <span class="va">daacs_complete_mice</span><span class="op">[</span><span class="op">-</span><span class="va">train_rows</span>,<span class="op">]</span></span></code></pre></div>
<p>With the missing DAACS data imputed we can train a logistic
regression model using the full data set.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mice_lr_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">retained</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">daacs_train_complete_mice</span>,</span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="va">logit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mice_lr_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mice_lr_out</span>, newdata <span class="op">=</span> <span class="va">daacs_valid_complete_mice</span>, type <span class="op">=</span> <span class="st">'response'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/confusion_matrix.html">confusion_matrix</a></span><span class="op">(</span>observed <span class="op">=</span> <span class="va">daacs_valid_complete_mice</span><span class="op">$</span><span class="va">retained</span>,</span>
<span>                 predicted <span class="op">=</span> <span class="va">mice_lr_predictions</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt;               predicted             </span></span>
<span><span class="co">#&gt;   observed        FALSE         TRUE</span></span>
<span><span class="co">#&gt;      FALSE 297 (19.20%) 384 (24.82%)</span></span>
<span><span class="co">#&gt;       TRUE 213 (13.77%) 653 (42.21%)</span></span>
<span><span class="co">#&gt; Accuracy: 61.41%</span></span>
<span></span>
<span><span class="va">mice_rf_out</span> <span class="op">&lt;-</span> <span class="fu">randomForest</span><span class="op">(</span>formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">retained</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                            data <span class="op">=</span> <span class="va">daacs_train_complete_mice</span><span class="op">)</span></span>
<span><span class="va">mice_rf_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mice_rf_out</span>, newdata <span class="op">=</span> <span class="va">daacs_valid_complete_mice</span>, type <span class="op">=</span> <span class="st">'response'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/confusion_matrix.html">confusion_matrix</a></span><span class="op">(</span>observed <span class="op">=</span> <span class="va">daacs_valid_complete_mice</span><span class="op">$</span><span class="va">retained</span>,</span>
<span>                 predicted <span class="op">=</span> <span class="va">mice_rf_predictions</span><span class="op">)</span></span>
<span><span class="co">#&gt;               predicted             </span></span>
<span><span class="co">#&gt;   observed        FALSE         TRUE</span></span>
<span><span class="co">#&gt;      FALSE 278 (17.97%) 403 (26.05%)</span></span>
<span><span class="co">#&gt;       TRUE 207 (13.38%) 659 (42.60%)</span></span>
<span><span class="co">#&gt; Accuracy: 60.57%</span></span></code></pre></div>
<p>The overall accuracy using only imputed data set is 61.41%</p>
</div>
</div>
<div class="section level2">
<h2 id="medley-models">Medley models<a class="anchor" aria-label="anchor" href="#medley-models"></a>
</h2>
<p>The <code>medley_train</code> function implements a step wise
approach to training models. The <code>data</code> and
<code>formula</code> parameters specify the data set and full model
(i.e. all possible predictor variables to be considered), similar to
other modeling functions in R. The <code>method</code> parameter
indicates what model procedure should be used. In this example we will
estimate logistic regression models. The <code>medley_train</code> can
take any additional parameters that need to be passed to the
<code>method</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">medley_lr_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/medley_train.html">medley_train</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">daacs_train</span>,</span>
<span>                              formula <span class="op">=</span> <span class="va">retained</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                              method <span class="op">=</span> <span class="va">glm</span>,</span>
<span>                              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="va">logit</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Table @ref(tab:model-summaries) provides the baseline retention rate
by model along with the number of observations and formula for each of
the models. Before exploring the specific of the modeling this reveals
that the pattern of missing data is predictive of success. Students who
complete all four DAACS assessments are % more likely to be retained
then students who did not complete any of the assessments.</p>
<table class="table">
<caption>Baseline retention rate by model</caption>
<colgroup>
<col width="3%">
<col width="3%">
<col width="4%">
<col width="88%">
</colgroup>
<thead><tr class="header">
<th align="right">Model</th>
<th align="right">n</th>
<th align="right">Success</th>
<th align="left">Formula</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1268</td>
<td align="right">70.98</td>
<td align="left">retained ~ page_views + srl + math + reading + writing
+ income + employment + ell + ed_mother + ed_father + ethnicity + gender
+ military + age</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">788</td>
<td align="right">58.25</td>
<td align="left">retained ~ page_views + srl + income + employment + ell
+ ed_mother + ed_father + ethnicity + gender + military + age</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">1551</td>
<td align="right">43.20</td>
<td align="left">retained ~ income + employment + ell + ed_mother +
ed_father + ethnicity + gender + military + age</td>
</tr>
</tbody>
</table>
<p>The object returned by <code>medley_train</code> contains the
following elements:</p>
<ul>
<li>
<code>n_models</code> - The number of models estimated.</li>
<li>
<code>formulas</code> - A list of the formulas used for each
model.</li>
<li>
<code>models</code> - A list containing the model output for each
model. In this example this would contain the results of the
<code>glm</code> function call.</li>
<li>
<code>data</code> - The full data set used to train the models.</li>
<li>
<code>model_observations</code> - A data frame indicating which
models each observation was used in. The rows correspond to the rows in
<code>data</code> and the columns correspond to the model.</li>
</ul>
<p>By default the algorithm will use all sets that have at least 10% of
the total observations (see @ref(tab:model-summaries)). This can be
adjusted using the <code>min_set_size</code> parameter (see the
<code><a href="../reference/get_variable_sets.html">get_variable_sets()</a></code> function). Optionally you can specify
the models directly by passing a list of formulas with the
<code>var_sets</code> parameter.</p>
<p>Table @ref(tab:modelresults) provides the model summaries for the 3
models estimated.</p>
<table class="table huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:modelresults">
<caption style="caption-side: top; text-align: center;">(#tab:modelresults) Logistic regression results</caption>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(1)</th>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(2)</th>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(3)</th>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(Intercept)</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.290    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.742)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.170    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.751)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.245    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.376)</td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">page_views</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.004    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.003)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.002    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.004)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">        </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">srl</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.132    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.159)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.190    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.180)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">        </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">math</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.429    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.382)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">        </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">        </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">reading</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.474    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.464)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">        </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">        </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">writing</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.153    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.425)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">        </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">        </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">income</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.003    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.029)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.046    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.035)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.062 *  </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.025)</td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">employment</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.152    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.087)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.190    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.104)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.047    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.072)</td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">ell</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.034    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.268)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.436    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.318)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.311    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.210)</td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">ed_mother</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.056    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.045)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.001    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.053)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.036    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.037)</td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">ed_father</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.011    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.044)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.093    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.052)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.024    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.036)</td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">ethnicityHispanic</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.241    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.251)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.438    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.264)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.123    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.186)</td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">ethnicityOther</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.015    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.265)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.212    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.284)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.250    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.201)</td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">ethnicityWhite</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.053    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.198)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.348    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.194)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.069    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.134)</td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">genderMALE</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.179    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.146)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.048    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.173)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.280 *  </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.120)</td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">militaryTRUE</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.869 ***</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.155)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.643 ***</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.178)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.721 ***</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.123)</td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">age</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.004    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.008)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.005    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.009)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.026 ***</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.006)</td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">N</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1268        </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">788        </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1551        </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">logLik</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-726.090    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-512.952    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1002.646    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
</tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">AIC</th>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1486.180    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1053.905    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2029.291    </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">     </td>
</tr>
<tr><th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.</th></tr>
</table>
<p>The S3 generic function <code>predict</code> has been implemented.
Specifying the <code>newdata</code> parameter will give predictions for
the validation data set.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">medley_lr_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">medley_lr_out</span>,</span>
<span>                                 newdata <span class="op">=</span> <span class="va">daacs_valid</span>,</span>
<span>                                 type <span class="op">=</span> <span class="st">'response'</span><span class="op">)</span></span></code></pre></div>
<p>The confusion matrix is provided below. The overall accuracy for the
medley model is 61.086% which is a 5.11% over the baseline, or
<em>null</em>, model.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/confusion_matrix.html">confusion_matrix</a></span><span class="op">(</span>observed <span class="op">=</span> <span class="va">daacs_valid</span><span class="op">$</span><span class="va">retained</span>,</span>
<span>                 predicted <span class="op">=</span> <span class="va">medley_lr_predictions</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt;               predicted             </span></span>
<span><span class="co">#&gt;   observed        FALSE         TRUE</span></span>
<span><span class="co">#&gt;      FALSE 305 (19.72%) 376 (24.31%)</span></span>
<span><span class="co">#&gt;       TRUE 175 (11.31%) 691 (44.67%)</span></span>
<span><span class="co">#&gt; Accuracy: 64.38%</span></span></code></pre></div>
<div class="section level3">
<h3 id="random-forests">Random Forests<a class="anchor" aria-label="anchor" href="#random-forests"></a>
</h3>
<p>The core functionality of the <code>medley_train</code> algorithm is
to select the most appropriate model given the available data. The
specific predictive model is up to the user. Fernandez-Delgado et al
(2014) evaluated the performance of 179 classifiers across 121 data
sets. Their results showed that, in general, random forest was the best
performing model. To begin, we load the <code>randomForest</code>
pacakge and convert our dependent variable to a factor to ensure a
classification (versus regression) model is estimated.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">daacs_train</span><span class="op">$</span><span class="va">retained</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">daacs_train</span><span class="op">$</span><span class="va">retained</span><span class="op">)</span></span>
<span><span class="va">daacs_valid</span><span class="op">$</span><span class="va">retained</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">daacs_valid</span><span class="op">$</span><span class="va">retained</span><span class="op">)</span></span></code></pre></div>
<p>Training and predicting are the same as above except we set
<code>method = randomForest</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">medley_rf_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/medley_train.html">medley_train</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">daacs_train</span>,</span>
<span>                              formula <span class="op">=</span> <span class="va">retained</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                              method <span class="op">=</span> <span class="va">randomForest</span><span class="op">)</span></span>
<span><span class="va">medley_rf_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">medley_rf_out</span>, </span>
<span>                                 newdata <span class="op">=</span> <span class="va">daacs_valid</span>,</span>
<span>                                 type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></code></pre></div>
<p>Lastly, the confusion matrix gives the overall accuracy. In this
example though we see the random forest performs sligthly worse than
logistic regression.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/confusion_matrix.html">confusion_matrix</a></span><span class="op">(</span>observed <span class="op">=</span> <span class="va">daacs_valid</span><span class="op">$</span><span class="va">retained</span>,</span>
<span>                 predicted <span class="op">=</span> <span class="va">medley_rf_predictions</span> <span class="op">)</span></span>
<span><span class="co">#&gt;            predicted             </span></span>
<span><span class="co">#&gt;   observed     FALSE         TRUE</span></span>
<span><span class="co">#&gt;      FALSE 0 (0.00%) 681 (44.02%)</span></span>
<span><span class="co">#&gt;       TRUE 0 (0.00%) 866 (55.98%)</span></span>
<span><span class="co">#&gt; Accuracy: 55.98%</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-observations-in-multiple-models">Using observations in multiple models<a class="anchor" aria-label="anchor" href="#using-observations-in-multiple-models"></a>
</h3>
<p>The default behavior of the <code>medley_train</code> algorithm is
for each observation to be used in only one model. However, in this
particular example, we have complete demographic data for all students
so we could potentially use all observations to train that model. The
<code>exclusive_membership</code> parameter will allow observations to
be used in training models for which there is complete data.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">medley_rf_out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/medley_train.html">medley_train</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">daacs_train</span>,</span>
<span>                              formula <span class="op">=</span> <span class="va">retained</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                              exclusive_membership <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                              method <span class="op">=</span> <span class="va">randomForest</span><span class="op">)</span></span>
<span><span class="va">medley_rf_predictions2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">medley_rf_out2</span>, </span>
<span>                          newdata <span class="op">=</span> <span class="va">daacs_valid</span>,</span>
<span>                          type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/confusion_matrix.html">confusion_matrix</a></span><span class="op">(</span>observed <span class="op">=</span> <span class="va">daacs_valid</span><span class="op">$</span><span class="va">retained</span>,</span>
<span>                 predicted <span class="op">=</span> <span class="va">medley_rf_predictions2</span> <span class="op">)</span></span>
<span><span class="co">#&gt;            predicted             </span></span>
<span><span class="co">#&gt;   observed     FALSE         TRUE</span></span>
<span><span class="co">#&gt;      FALSE 0 (0.00%) 681 (44.02%)</span></span>
<span><span class="co">#&gt;       TRUE 0 (0.00%) 866 (55.98%)</span></span>
<span><span class="co">#&gt; Accuracy: 55.98%</span></span></code></pre></div>
<p>As the results above show we get a very modest increase in the
overall accuracy. It should be noted that predictions are estimated from
the model that uses most variables for each observation.</p>
</div>
</div>
<div class="section level2">
<h2 id="discussion">Discussion<a class="anchor" aria-label="anchor" href="#discussion"></a>
</h2>
<table class="table">
<caption>Model performance summary</caption>
<thead><tr class="header">
<th align="left">Method</th>
<th align="right">Accuracy</th>
<th align="right">Improvement</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Observed data only logistic regression</td>
<td align="right">61.09</td>
<td align="right">4.92</td>
</tr>
<tr class="even">
<td align="left">Observed data only random forest</td>
<td align="right">57.79</td>
<td align="right">1.62</td>
</tr>
<tr class="odd">
<td align="left">Mean imputed data set with logistic regression</td>
<td align="right">61.15</td>
<td align="right">4.98</td>
</tr>
<tr class="even">
<td align="left">Mean imputed data set with random forest</td>
<td align="right">64.90</td>
<td align="right">8.73</td>
</tr>
<tr class="odd">
<td align="left">Mice imputed data set logistic regression</td>
<td align="right">61.41</td>
<td align="right">5.24</td>
</tr>
<tr class="even">
<td align="left">Mice imputed data set random forest</td>
<td align="right">60.57</td>
<td align="right">4.40</td>
</tr>
<tr class="odd">
<td align="left">Medley with logistic regression</td>
<td align="right">64.38</td>
<td align="right">8.21</td>
</tr>
<tr class="even">
<td align="left">Medley with random forest</td>
<td align="right">64.12</td>
<td align="right">7.95</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> Improvement is the difference with the overall
retention rate of 56.17%.</p>
<pre><code>                                                    Predicted                      
                                  Model Observed        FALSE         TRUE Accuracy
 Observed data only logistic regression    FALSE 295 (19.07%) 386 (24.95%)         
                                            TRUE 216 (13.96%) 650 (42.02%)         
                                                                             61.09%
       Observed data only random forest    FALSE 279 (18.03%) 402 (25.99%)         
                                            TRUE 251 (16.22%) 615 (39.75%)         
                                                                             57.79%
   Imputed data set logistic regression    FALSE 297 (19.20%) 384 (24.82%)         
                                            TRUE 213 (13.77%) 653 (42.21%)         
                                                                             61.41%
         Imputed data set random forest    FALSE 278 (17.97%) 403 (26.05%)         
                                            TRUE 207 (13.38%) 659 (42.60%)         
                                                                             60.57%
        Medley with logistic regression    FALSE 305 (19.72%) 376 (24.31%)         
                                            TRUE 175 (11.31%) 691 (44.67%)         
                                                                             64.38%
              Medley with random forest    FALSE 320 (20.69%) 361 (23.34%)         
                                            TRUE 194 (12.54%) 672 (43.44%)         
                                                                             64.12%</code></pre>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-ComplexHeatmap" class="csl-entry">
Gu, Zuguang, Roland Eils, and Matthias Schlesner. 2016. <span>“Complex
Heatmaps Reveal Patterns and Correlations in Multidimensional Genomic
Data.”</span> <em>Bioinformatics</em>. <a href="https://doi.org/10.1093/bioinformatics/btw313" class="external-link">https://doi.org/10.1093/bioinformatics/btw313</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jason Bryer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
